{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\blelm\\\\Desktop\\\\AppCreate\\\\habitPlan\\\\src\\\\components\\\\view\\\\TaskModal.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from \"react\";\nimport { makeStyles, createStyles } from \"@material-ui/core/styles\";\nimport Modal from \"@material-ui/core/Modal\";\nimport Backdrop from \"@material-ui/core/Backdrop\";\nimport Fade from \"@material-ui/core/Fade\";\nimport InputN from \"./InputNormal\";\nimport AppVar from \"./AppVar\";\nimport PatternSwitchList from \"./PatternSwitch\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { taskRegister } from \"../../modules/tasksModule\";\nimport { useRegisterData, useUpdateData } from \"../test/firebaseTest/DBFetch\";\nvar useStyles = makeStyles(function (theme) {\n  return createStyles({\n    modal: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\" // width: \"80%\",\n      // height: \"80%\",\n\n    },\n    paper: {\n      backgroundColor: theme.palette.background.paper,\n      width: \"50%\",\n      height: \"80%\",\n      overflowY: \"scroll\",\n      border: \"2px solid #000\",\n      boxShadow: theme.shadows[5],\n      padding: theme.spacing(2, 4, 3)\n    }\n  });\n});\nvar contentsList = [{\n  label: \"if-thenプランニング\",\n  value: \"\"\n}, {\n  label: \"習慣の積み上げ\",\n  value: \"\"\n}, {\n  label: \"パターン\",\n  value: \"\"\n}, {\n  label: \"気が進まないとき\",\n  value: \"\"\n}, {\n  label: \"長期的に見返りのある習慣の即時的な楽しみ\",\n  value: \"\"\n}, {\n  label: \"目標\",\n  value: \"\"\n}, {\n  label: \"守れなかった時の罰則\",\n  value: \"\"\n}, {\n  label: \"レベル\",\n  value: \"\"\n}, {\n  label: \"避けることで得られるメリット\",\n  value: \"\"\n}, {\n  label: \"見返りのない習慣に対する即時的な痛み\",\n  value: \"\"\n}, {\n  label: \"タスク名\",\n  value: \"\"\n}];\nexport default function TaskModal(props) {\n  _s();\n\n  var _this = this;\n\n  var classes = useStyles();\n\n  var _useSelector = useSelector(function (state) {\n    return state.tasks;\n  }),\n      userTaskInfo = _useSelector.userTaskInfo;\n\n  var updateData = useUpdateData();\n  var registerData = useRegisterData();\n  var checkNew = userTaskInfo.tasks.length < parseInt(props.index);\n  var stateChecked = [];\n  var renderContentsList = contentsList.filter(function (content) {\n    return content.label != 'タスク名';\n  });\n  var setContentsList = contentsList;\n\n  if (!checkNew) {\n    stateChecked = props.task.patternInfo.map(function (content) {\n      return content.patternID;\n    });\n    setContentsList = contentsList.filter(function (content) {\n      return content.label != 'タスク名';\n    });\n  }\n\n  var _React$useState = React.useState(stateChecked),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      checked = _React$useState2[0],\n      setChecked = _React$useState2[1];\n\n  var dispatch = useDispatch(); // 配列を作って項目一覧を作るなら、その配列を使って以下の変数の初期設定もやりたいところ\n  // 最終的には項目一覧もReduxで管理したい。それをタスク一覧の右上に表示した設定ボタンから開くモーダルでONOFFを設定することで、タスク詳細画面で使う項目を選べる。新規登録時もONになっている項目が表示される\n  // タスク詳細画面でプラスボタンを押したら項目を増やせる。それも項目一覧に保管される。\n  // const defaultTask: newTasksType = { [\"追加\"]: \"追加\" };\n\n  var _React$useState3 = React.useState(setContentsList),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      contents = _React$useState4[0],\n      setContents = _React$useState4[1];\n\n  var handleClose = function handleClose() {\n    props.setOpen(9999);\n  };\n\n  function HandleRegister() {\n    return _HandleRegister.apply(this, arguments);\n  }\n\n  function _HandleRegister() {\n    _HandleRegister = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var details, patternInfo, newTasks;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              contents.map(function (content, index) {\n                details = _objectSpread(_objectSpread({}, details), {}, _defineProperty({}, content.label, content.value));\n              });\n              patternInfo = checked.map(function (content) {\n                return {\n                  patternID: content,\n                  order: 1\n                };\n              });\n              newTasks = {\n                detail: details,\n                patternInfo: patternInfo\n              };\n              _context.next = 5;\n              return dispatch(taskRegister(newTasks));\n\n            case 5:\n              console.log('==============check register=============='); // console.log(userTaskInfo);\n              // const _sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\n              // await _sleep(5000);\n              // console.log(userTaskInfo);\n              // console.log(componentWillReceiveProps(nextProps));\n              // registerData(newTasks);\n\n              props.setOpen(9999);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _HandleRegister.apply(this, arguments);\n  }\n\n  ; // ここは配列で管理してmapで表示したいところ\n  // task型の変数を用意して、それに値を格納する\n  // 新規だったら登録、すでにある項目であれば更新する。\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  }, __jsx(Modal, {\n    \"aria-labelledby\": \"transition-modal-title\",\n    \"aria-describedby\": \"transition-modal-description\",\n    className: classes.modal,\n    open: props.index == props.open,\n    onClose: handleClose,\n    closeAfterTransition: true,\n    BackdropComponent: Backdrop,\n    BackdropProps: {\n      timeout: 500\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }\n  }, __jsx(Fade, {\n    \"in\": props.index == props.open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: classes.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 21\n    }\n  }, __jsx(AppVar, {\n    handleRegister: HandleRegister,\n    checkNew: checkNew,\n    index: props.index,\n    contents: contents,\n    setContents: setContents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }), __jsx(\"h2\", {\n    id: \"transition-modal-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 25\n    }\n  }, \"\\u30BF\\u30B9\\u30AF\\u8A73\\u7D30\\u753B\\u9762\", props.index + 1), __jsx(\"p\", {\n    id: \"transition-modal-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 25\n    }\n  }, \"react-transition-group animates me.\"), __jsx(PatternSwitchList, {\n    checked: checked,\n    setChecked: setChecked,\n    index: props.index,\n    checkNew: checkNew,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 25\n    }\n  }), renderContentsList.map(function (content, index) {\n    return __jsx(\"div\", {\n      key: content.label + \"_\" + index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 33\n      }\n    }, __jsx(InputN // label=\"if-thenプランニング\"\n    , {\n      label: content.label,\n      required: false,\n      index: props.index,\n      contentIndex: index,\n      contents: contents,\n      setContents: setContents,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 37\n      }\n    }), __jsx(\"br\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 37\n      }\n    }));\n  })))));\n}\n\n_s(TaskModal, \"kI+r4QmChg979VqQq/Kr21QK7JM=\", false, function () {\n  return [useStyles, useSelector, useUpdateData, useRegisterData, useDispatch];\n});\n\n_c = TaskModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"TaskModal\");","map":{"version":3,"sources":["C:/Users/blelm/Desktop/AppCreate/habitPlan/src/components/view/TaskModal.tsx"],"names":["React","makeStyles","createStyles","Modal","Backdrop","Fade","InputN","AppVar","PatternSwitchList","useDispatch","useSelector","taskRegister","useRegisterData","useUpdateData","useStyles","theme","modal","display","alignItems","justifyContent","paper","backgroundColor","palette","background","width","height","overflowY","border","boxShadow","shadows","padding","spacing","contentsList","label","value","TaskModal","props","classes","state","tasks","userTaskInfo","updateData","registerData","checkNew","length","parseInt","index","stateChecked","renderContentsList","filter","content","setContentsList","task","patternInfo","map","patternID","useState","checked","setChecked","dispatch","contents","setContents","handleClose","setOpen","HandleRegister","details","order","newTasks","detail","console","log","open","timeout"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { makeStyles, Theme, createStyles } from \"@material-ui/core/styles\";\r\nimport Modal from \"@material-ui/core/Modal\";\r\nimport Backdrop from \"@material-ui/core/Backdrop\";\r\nimport Fade from \"@material-ui/core/Fade\";\r\nimport InputN from \"./InputNormal\";\r\nimport AppVar from \"./AppVar\";\r\nimport { tasks } from \"../../modules/userTasksType\";\r\nimport PatternSwitchList from \"./PatternSwitch\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { taskRegister } from \"../../modules/tasksModule\";\r\nimport { RootState } from \"../../modules/rootReducer\";\r\nimport { useRegisterData, useUpdateData } from \"../test/firebaseTest/DBFetch\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        modal: {\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            // width: \"80%\",\r\n            // height: \"80%\",\r\n        },\r\n        paper: {\r\n            backgroundColor: theme.palette.background.paper,\r\n            width: \"50%\",\r\n            height: \"80%\",\r\n            overflowY: \"scroll\",\r\n            border: \"2px solid #000\",\r\n            boxShadow: theme.shadows[5],\r\n            padding: theme.spacing(2, 4, 3),\r\n        },\r\n    })\r\n);\r\n\r\nconst contentsList = [\r\n    {\r\n        label: \"if-thenプランニング\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"習慣の積み上げ\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"パターン\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"気が進まないとき\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"長期的に見返りのある習慣の即時的な楽しみ\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"目標\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"守れなかった時の罰則\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"レベル\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"避けることで得られるメリット\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"見返りのない習慣に対する即時的な痛み\",\r\n        value: \"\",\r\n    },\r\n    {\r\n        label: \"タスク名\",\r\n        value: \"\",\r\n    },\r\n];\r\n\r\nexport default function TaskModal(props: any) {\r\n    const classes = useStyles();\r\n    const { userTaskInfo } = useSelector((state: RootState) => state.tasks);\r\n    const updateData = useUpdateData();\r\n    const registerData = useRegisterData();\r\n\r\n    const checkNew = userTaskInfo.tasks.length < parseInt(props.index);\r\n    let stateChecked: number[] = [];\r\n    const renderContentsList = contentsList.filter((content) => {\r\n        return content.label != 'タスク名'\r\n    })\r\n    let setContentsList = contentsList;\r\n    if (!checkNew) {\r\n        stateChecked = props.task.patternInfo.map(\r\n            (content: { patternID: number; order: number }) => {\r\n                return content.patternID;\r\n            }\r\n        );\r\n        setContentsList = contentsList.filter((content) => {\r\n            return content.label != 'タスク名'\r\n        })\r\n    }\r\n    const [checked, setChecked] = React.useState<number[]>(stateChecked);\r\n    const dispatch = useDispatch();\r\n    // 配列を作って項目一覧を作るなら、その配列を使って以下の変数の初期設定もやりたいところ\r\n    // 最終的には項目一覧もReduxで管理したい。それをタスク一覧の右上に表示した設定ボタンから開くモーダルでONOFFを設定することで、タスク詳細画面で使う項目を選べる。新規登録時もONになっている項目が表示される\r\n    // タスク詳細画面でプラスボタンを押したら項目を増やせる。それも項目一覧に保管される。\r\n    // const defaultTask: newTasksType = { [\"追加\"]: \"追加\" };\r\n    const [contents, setContents] = React.useState(setContentsList);\r\n\r\n    const handleClose = () => {\r\n        props.setOpen(9999);\r\n    };\r\n\r\n    async function HandleRegister() {\r\n        let details: {\r\n            [content: string]: string;\r\n        };\r\n        contents.map((content, index) => {\r\n            details = {\r\n                ...details,\r\n                [content.label]: content.value,\r\n            };\r\n        });\r\n\r\n        let patternInfo: {\r\n            patternID: number;\r\n            order: number;\r\n        }[];\r\n\r\n        patternInfo = checked.map((content) => {\r\n            return {\r\n                patternID: content,\r\n                order: 1,\r\n            };\r\n        });\r\n\r\n        let newTasks: tasks = {\r\n            detail: details,\r\n            patternInfo: patternInfo,\r\n        };\r\n\r\n        await dispatch(taskRegister(newTasks));\r\n        console.log('==============check register==============');\r\n        // console.log(userTaskInfo);\r\n        // const _sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\r\n        // await _sleep(5000);\r\n        // console.log(userTaskInfo);\r\n        // console.log(componentWillReceiveProps(nextProps));\r\n        \r\n        // registerData(newTasks);\r\n\r\n        props.setOpen(9999);\r\n    };\r\n\r\n\r\n\r\n    // ここは配列で管理してmapで表示したいところ\r\n    // task型の変数を用意して、それに値を格納する\r\n    // 新規だったら登録、すでにある項目であれば更新する。\r\n    return (\r\n        <div>\r\n            {/* <button type=\"button\" onClick={handleOpen}>\r\n                react-transition-group\r\n            </button> */}\r\n            <Modal\r\n                aria-labelledby=\"transition-modal-title\"\r\n                aria-describedby=\"transition-modal-description\"\r\n                className={classes.modal}\r\n                open={props.index == props.open}\r\n                onClose={handleClose}\r\n                closeAfterTransition\r\n                BackdropComponent={Backdrop}\r\n                BackdropProps={{\r\n                    timeout: 500,\r\n                }}\r\n            >\r\n                <Fade in={props.index == props.open}>\r\n                    <div className={classes.paper}>\r\n                        <AppVar\r\n                            handleRegister={HandleRegister}\r\n                            checkNew={checkNew}\r\n                            index={props.index}\r\n                            contents={contents}\r\n                            setContents={setContents}\r\n                        />\r\n                        <h2 id=\"transition-modal-title\">\r\n                            タスク詳細画面{props.index + 1}\r\n                        </h2>\r\n                        <p id=\"transition-modal-description\">\r\n                            react-transition-group animates me.\r\n                        </p>\r\n                        {/* ここを要修正。パターンは選択式ではいけない。複数登録する可能性があるため。登録済み以外のリストをfliterで作成して表示、とかかな。 */}\r\n                        {/* <SimpleSelect choice={choice} setChoice={setChoice} /> */}\r\n                        <PatternSwitchList\r\n                            checked={checked}\r\n                            setChecked={setChecked}\r\n                            index={props.index}\r\n                            checkNew={checkNew}\r\n                        />\r\n                        {renderContentsList.map((content, index) => {\r\n                            return (\r\n                                <div key={content.label + \"_\" + index}>\r\n                                    <InputN\r\n                                        // label=\"if-thenプランニング\"\r\n                                        label={content.label}\r\n                                        required={false}\r\n                                        index={props.index}\r\n                                        contentIndex={index}\r\n                                        contents={contents}\r\n                                        setContents={setContents}\r\n                                    />\r\n                                    <br></br>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </Fade>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}